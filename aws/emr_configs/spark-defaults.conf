# Storage format extensions (Delta Lake - default, can be overridden by config)
spark.sql.extensions=io.delta.sql.DeltaSparkSessionExtension
spark.sql.catalog.spark_catalog=org.apache.spark.sql.delta.catalog.DeltaCatalog

# Apache Iceberg configuration (enabled when storage.format=iceberg in config)
# Iceberg extensions (commented out by default, enabled via SparkSession builder when format=iceberg)
# spark.sql.extensions=org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions
# spark.sql.catalog.glue_catalog=org.apache.iceberg.spark.SparkCatalog
# spark.sql.catalog.glue_catalog.warehouse=s3://company-data-lake-123456789012/
# spark.sql.catalog.glue_catalog.catalog-impl=org.apache.iceberg.aws.glue.GlueCatalog
# spark.sql.catalog.glue_catalog.io-impl=org.apache.iceberg.aws.s3.S3FileIO
# spark.sql.catalog.glue_catalog.glue.region=us-east-1

spark.serializer=org.apache.spark.serializer.KryoSerializer
spark.sql.adaptive.enabled=true
spark.sql.adaptive.coalescePartitions.enabled=true
spark.sql.adaptive.skewJoin.enabled=true
spark.sql.adaptive.localShuffleReader.enabled=true
spark.sql.adaptive.advisoryPartitionSizeInBytes=128m
spark.sql.adaptive.maxShuffledHashJoinLocalMapThreshold=0
spark.sql.adaptive.maxBroadcastHashJoinLocalMapThreshold=0
spark.sql.adaptive.optimizeSkewedJoin.enabled=true
spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes=256m
spark.sql.adaptive.skewJoin.skewedPartitionFactor=5
spark.sql.adaptive.coalescePartitions.minPartitionNum=1
spark.sql.adaptive.coalescePartitions.initialPartitionNum=200
spark.sql.adaptive.coalescePartitions.parallelismFirst=false
spark.sql.adaptive.fetchShuffleBlocksInBatch.enabled=true
spark.sql.adaptive.nonEmptyPartitionRatioForBroadcastJoin=0.2
spark.executor.memory=8g
spark.executor.cores=4
spark.driver.memory=4g
spark.sql.shuffle.partitions=200
spark.default.parallelism=200
spark.databricks.delta.optimizeWrite.enabled=true
spark.databricks.delta.autoCompact.enabled=true
spark.databricks.delta.properties.defaults.enableChangeDataFeed=true

