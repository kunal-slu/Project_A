# OpenLineage Configuration
# This config file defines settings for data lineage tracking via OpenLineage

lineage:
  enabled: true
  url: "${OPENLINEAGE_URL}"  # Set via environment variable or MWAA variable
  namespace: "${OPENLINEAGE_NAMESPACE}"  # e.g., "prod-data-platform"
  api_key_secret: "${OPENLINEAGE_API_KEY_SECRET}"  # AWS Secrets Manager secret name (optional)
  
  # OpenLineage client settings
  timeout_seconds: 5
  retry_attempts: 3
  retry_backoff_seconds: 1
  
  # Events to emit
  emit_job_start: true
  emit_job_complete: true
  emit_job_fail: true
  emit_dataset_input: true
  emit_dataset_output: true
  
  # Metadata to include
  include_spark_metrics: true
  include_row_counts: true
  include_schema_info: true
  
  # Namespace prefixes for different data sources
  namespaces:
    s3: "s3://"
    bronze: "bronze"
    silver: "silver"
    gold: "gold"
    
# CloudWatch Metrics Export (additional to OpenLineage)
cloudwatch:
  enabled: true
  namespace: "ETLPipelineMetrics"
  region: "${AWS_REGION}"
  
  # Metrics to emit
  metrics:
    - name: "records.processed"
      unit: "Count"
      dimensions: ["job_name", "table_name"]
    - name: "records.failed"
      unit: "Count"
      dimensions: ["job_name", "error_type"]
    - name: "job.duration"
      unit: "Seconds"
      dimensions: ["job_name", "status"]
    - name: "dq.checks.failed"
      unit: "Count"
      dimensions: ["suite_name", "check_name"]
      
# Prometheus Export (optional, for self-hosted monitoring)
prometheus:
  enabled: false
  port: 9090
  path: "/metrics"
